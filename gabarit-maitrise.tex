% !TEX encoding = UTF-8 Unicode
%% GABARIT POUR MÉMOIRE STANDARD
%%
%% Consulter la documentation de la classe ulthese pour une
%% description détaillée de la classe, de ce gabarit et des options
%% disponibles.
%%
%% [Ne pas hésiter à supprimer les commentaires après les avoir lus.]
%%
%% Déclaration de la classe avec le type de grade
%%   [l'un de MATDR, MArch, MA, LLM, MErg, MMus, MPht, MSc, MScGeogr,
%%    MServSoc, MPsEd]
%% et les langues les plus courantes. Le français sera la langue par
%% défaut du document.
\documentclass[MSc,english,french]{ulthese}

%% Encodage utilisé pour les caractères accentués dans les fichiers
%% source du document. Les gabarits sont encodés en UTF-8. Inutile
%% avec XeLaTeX, qui gère Unicode nativement.
\ifxetex\else \usepackage[utf8]{inputenc} \fi
%% Charger ici les autres paquetages nécessaires pour le document.
%% Quelques exemples; décommenter au besoin.
\usepackage{amsmath}       % recommandé pour les mathématiques
\usepackage{amssymb}    % using for intercal symbol
%\usepackage{icomma}        % gestion de la virgule dans les nombres
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage{outlines}  % for nested lists
\graphicspath{ {./images/} }
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{natbib}   % for citep command
\usepackage{array}  % for arraybackslash command in tables
\usepackage{booktabs}  % for table formatting
\renewcommand{\arraystretch}{1.4}  % Makes table row heights higher
\usepackage{multirow}  % for table column headings in discussion
\usepackage[raggedrightboxes]{ragged2e}  % for table column headings in discussion
\usepackage{hyperref}

 % \usepackage{easyReview}  % Only used for highlighting edits - REMOVE IN FINAL DRAFT

% This package raises warnings 'overriding \printglossary'. 'overriding 'theglossary' environment
%\usepackage{glossaries}
\usepackage[toc,acronym]{glossaries}
% The command \makeglossaries must be written before the first glossary entry.
\makeglossaries
% The command \printglossaries is the one that will actually render the list of words and definitions
% According to this, these warnings can be ignored:
% https://tex.stackexchange.com/questions/163479/glossaries-conflict-with-memoir


% Acronyms
\newacronym{SAG}{SAG}{semi-autogenous grinding}
\newacronym{AG}{AG}{autogenous grinding mill}
\newacronym{MPC}{MPC}{model predictive control}
\newacronym{PI}{PI}{proportional-integral (control)}
\newacronym{PID}{PID}{proportional-integral-derivative}
\newacronym{SISO}{SISO}{single-input, single-output}
\newacronym{MIMO}{MIMO}{multiple-input, multiple-output}
\newacronym{MJLS}{MJLS}{Markov jump linear system}
\newacronym{EKF}{EKF}{extended Kalman filter}
\newacronym{RODD}{RODD}{randomly-occurring deterministic disturbance}
\newacronym{ARIMA}{ARIMA}{autoregressive integrated moving average}
\newacronym{kWh}{kWh}{kilowatt-hours}
\newacronym{MLE}{MLE}{maximum likelihood estimation}
\newacronym{DOB}{DOB}{disturbance observer based}
\newacronym{LQG}{LQG}{linear quadratic Gaussian}
\newacronym{GMM}{GMM}{Gaussian mixture model}
\newacronym{EM}{EM}{expectation maximisation}
\newacronym{BRW}{BRW}{bounded random walk}
\newacronym{HMM}{HMM}{hidden Markov model}
\newacronym{RMSE}{RMSE}{root-mean-squared error}
\newacronym{MKF}{MKF}{multiple-model Kalman filter}
\newacronym{SKF}{SKF}{Kalman filter with pre-scheduled mode switching}
\newacronym{GPB}{GPB}{generalised pseudo-Bayesian}
\newacronym{GPB1}{GPB1}{first-order generalised pseudo-Bayesian estimator}
\newacronym{GPB2}{GPB2}{second order generalised pseudo-Bayesian estimator}
\newacronym{AFMM}{AFMM}{adaptive forgetting through multiple models}
\newacronym{RMSD}{RMSD}{root-mean-squared differences}
\newacronym{PSD}{PSD}{particle size distribution}
\newacronym{P80}{P80}{80\% passing size, a measure of a particle size distribution}
\newacronym{PRNG}{PRNG}{pseudo-random number generator}
\newacronym{SMC}{SMC}{sequential Monte Carlo}
\newacronym{PRBS}{PRBS}{pseudo-random binary sequence}
\newacronym{SNR}{SNR}{signal-to-noise ratio}

% NOTE: Don't add periods at end of description.  Don't use capitals at beginning of description.
% General notation
\newglossaryentry{Ndist2}{name={$\mathcal{N}(\mathbf{y}, \mathbf{\mu}, \Sigma)$}, 
	description={multivariate normal probability density of $\mathbf{y}$ with mean $\mathbf{\mu}$ and covariance $\Sigma$}}
\newglossaryentry{Ndist}{name={$\mathcal{N}(0,\sigma_{w_p}^2)$}, 
	description={normal distribution with mean zero and variance $\sigma_{w_p}^2$}}
\newglossaryentry{pagb}{name={$p(a \mid b)$}, description={probability density of $a$ given $b$}}
\newglossaryentry{PrAgB}{name={$\Pr(A \mid B)$}, description={probability of $A$ given $B$}}
\newglossaryentry{nabla}{name=\ensuremath{\nabla}, description={defined as $1-q^{-1}$}}
\newglossaryentry{gammak}{name=\ensuremath{\gamma(k)}, description={random shock indicator at time $k$}}
\newglossaryentry{identity}{name={$\mathbf{I}_n$}, description={the identity matrix ($n \times n$)}}

% Signals
\newglossaryentry{Ts}{name=\ensuremath{T_s}, description={sampling interval in units of time}}
\newglossaryentry{N}{name=\ensuremath{N}, description={length of simulation in number of sampling intervals}}
\newglossaryentry{uk}{name=\ensuremath{\mathbf{u}(k)}, description={system inputs at time $k$}}
\newglossaryentry{xk}{name=\ensuremath{\mathbf{x}(k)}, description={system states at time $k$}}
\newglossaryentry{yk}{name=\ensuremath{\mathbf{y}(k)}, description={system outputs at time $k$}}
\newglossaryentry{wk}{name=\ensuremath{\mathbf{w}(k)}, description={process disturbances at time $k$}}
\newglossaryentry{vk}{name=\ensuremath{\mathbf{v}(k)}, description={measurement noises at time $k$}}
\newglossaryentry{A}{name=\ensuremath{\mathbf{A}}, description={transition matrix of the system model}}
\newglossaryentry{B}{name=\ensuremath{\mathbf{B}}, description={input matrix of the system model}}
\newglossaryentry{C}{name=\ensuremath{\mathbf{C}}, description={output matrix of the system model}}
\newglossaryentry{yMk}{name=\ensuremath{\mathbf{y}_M(k)}, description={system output measurements at time $k$}}
%\newglossaryentry{pk}{name=\ensuremath{p(k)}, description={disturbance signal at time $k$}}
\newglossaryentry{wpk}{name=\ensuremath{w_p(k)}, description={random shock signal at time $k$}}
\newglossaryentry{rk}{name=\ensuremath{\mathbf{r}(k)}, description={mode indicator of a switching system at time $k$ (vector)}}
\newglossaryentry{porek}{name=\ensuremath{p_\text{ore}(k)}, description={simulated ore disturbance signal at time $k$}}
\newglossaryentry{np}{name=\ensuremath{n_p}, description={number of independent random shocks}}

% Disturbance models
\newglossaryentry{epsilon}{name=\ensuremath{\varepsilon}, description={probability of a random shock}}
\newglossaryentry{sigmawp}{name=\ensuremath{\sigma_{w_p}}, description={standard deviation of the persistent noise component of the random shock variable}}
\newglossaryentry{sigmawp2}{name=\ensuremath{\sigma_{w_p}^2}, description={variance of the persistent noise component of the random shock variable}}
\newglossaryentry{b}{name=\ensuremath{b}, description={ratio of the variance of the shocks and the persistent noise components of the random shock process}}
\newglossaryentry{Piwp}{name={$\Pi_{w_{p}}$}, description={transition probability matrix of the disturbance process $w_p$}}
\newglossaryentry{sigmaM}{name=\ensuremath{\sigma_M}, description={standard deviation of the measurement noise}}

% State estimation
\newglossaryentry{xkp1_pred}{name={$\hat{\mathbf{x}}(k+1 \mid k)$}, description={predictions of system states at time $k+1$ made with information available at time $k$}}
\newglossaryentry{xk_pred}{name={$\hat{\mathbf{x}}(k \mid k-1)$}, description={predictions of system states at time $k$ made with information available at time $k-1$}}
\newglossaryentry{xk_hat}{name={$\hat{\mathbf{x}}(k \mid k)$}, description={estimates of system states at time $k$ made with information available at time $k$}}
\newglossaryentry{yk_hat}{name={$\hat{\mathbf{y}}(k \mid k)$}, description={estimates of system outputs at time $k$ made with information available at time $k$}}
\newglossaryentry{Kpk}{name={$\mathbf{K}_p(k)$}, description={correction gain of the Kalman filter (prediction form)}}
\newglossaryentry{Kk}{name={$\mathbf{K}(k)$}, description={correction gain of the Kalman filter (filtering form)}}
\newglossaryentry{Kfk}{name={$\mathbf{K}_f(k)$}, description={correction gain of the Kalman filter (filtering form), or correction gain of Kalman filter $f$ (filtering form)}}
\newglossaryentry{Sk}{name=\ensuremath{\mathbf{S}(k)}, description={covariance of the output prediction errors at time $k$}}
\newglossaryentry{Sfk}{name=\ensuremath{\mathbf{S}_f(k)}, description={covariance of the output prediction errors of Kalman filter $f$ at time $k$}}
\newglossaryentry{Pk}{name={$\mathbf{P}(k \mid k)$}, description={state estimation error covariance at time $k$ made with information available at time $k$}}
\newglossaryentry{Pkp1_pred}{name={$\mathbf{P}(k+1 \mid k)$}, description={predictions of the state estimation error covariance at time $k+1$ made with information available at time $k$}}
\newglossaryentry{Pk_pred}{name={$\mathbf{P}(k \mid k-1)$}, description={predictions of the state estimation error covariance at time $k$ made with information available at time $k-1$}}
\newglossaryentry{Qset}{name=\ensuremath{\mathcal{Q}}, description={set of process noise covariance matrices of a switching system model}}
\newglossaryentry{Qk}{name=\ensuremath{\mathbf{Q}(k)}, description={covariance of the process disturbances in the observer model at time $k$}}
\newglossaryentry{R}{name=\ensuremath{\mathbf{R}}, description={covariance of the measurement noises in the observer model}}
\newglossaryentry{E}{name={$\mathbb{E}\{\cdot\}$}, description={expectation operator}}
\newglossaryentry{wpkv}{name={$\mathbf{w}_p(k)$}, description={disturbance model noise inputs at time $k$}}
\newglossaryentry{xak}{name={$\mathbf{x}_a(k)$}, description={augmented system states at time $k$}}
\newglossaryentry{Aa}{name={$\mathbf{A}_a$}, description={transition matrix of the augmented system model}}
\newglossaryentry{Ba}{name={$\mathbf{B}_a$}, description={input matrix of the augmented system model}}
\newglossaryentry{Ca}{name={$\mathbf{C}_a$}, description={output matrix of the augmented system model}}
\newglossaryentry{RMSEY}{name=\ensuremath{\mathrm{RMSE}(\hat{Y},Y)}, description={root-mean-squared error of the output estimates compared to the true system outputs}}
\newglossaryentry{RMSEYM}{name=\ensuremath{\mathrm{RMSE}(\hat{Y},Y_M)}, description={root-mean-squared error of the output estimates compared to the system output meaurements}}

% Multiple model approaches
\newglossaryentry{nj}{name=\ensuremath{n_j}, description={number and modes or models of a switching system}}
\newglossaryentry{nh}{name=\ensuremath{n_h}, description={number of hypotheses}}
\newglossaryentry{gamma_fk}{name=\ensuremath{\gamma_f(k)}, description={random shock indicator of hypothesis $f$ at time $k$}}
\newglossaryentry{Gammafk}{name=\ensuremath{\Gamma_f(k)}, description={shock indicator hypotheses sequence $f$ from time $0$ to $k$}}
\newglossaryentry{Gammafkmnk}{name=\ensuremath{\Gamma_m(k-N_f+1,k)}, description={shock indicator hypotheses sequence $f$ over the fusion horizon}}
\newglossaryentry{nm}{name=\ensuremath{n_m}, description={number of merged hypotheses}}
\newglossaryentry{Zmk}{name=\ensuremath{Z_m(k)}, description={normalization variable at time $k$ used in merged probability calculations}}
\newglossaryentry{Hbranch}{name=\ensuremath{\mathcal{H}_{\text{branch}}}, description={hypothesis index used in branching operations}}
\newglossaryentry{Hmerge}{name=\ensuremath{\mathcal{H}_{\text{merge}}}, description={hypothesis index used in merging operations}}
\newglossaryentry{rmk}{name=\ensuremath{\mathbf{r}_m(k)}, description={indicator of the system modes of the merged hypotheses at time $k$ used in branching and merging operations}}
\newglossaryentry{rb1k}{name=\ensuremath{\mathbf{r}_{b,1}(k)}, description={indicators of the system modes of the branched hypotheses at time $k$ before merging}}
\newglossaryentry{rb2k}{name=\ensuremath{\mathbf{r}_{b,2}(k)}, description={indicators of the system modes of the branched hypotheses at time $k$ after branching}}
\newglossaryentry{nf}{name=\ensuremath{N_f}, description={sequence fusion parameter: length of fusion horizon in number of sampling intervals}}
\newglossaryentry{m}{name=\ensuremath{n_\text{max}}, description={sequence fusion parameter: maximum number of shock occurrences within the fusion horizon}}
\newglossaryentry{d}{name=\ensuremath{N_d}, description={sequence fusion parameter: shock spacing parameter or length of detection interval, in number of sampling intervals}}
\newglossaryentry{nmin}{name=\ensuremath{N_\text{min}}, description={sequence pruning parameter: minimum life of a branched hypothesis}}
\newglossaryentry{epsilond}{name=\ensuremath{\varepsilon_d}, description={sequence fusion parameter: probability of at least one shock within the detection interval}}
\newglossaryentry{beta}{name=\ensuremath{\beta}, description={sequence fusion parameter: total probability of the modelled shock hypothesis sequences}}
\newglossaryentry{xfk_hat}{name={$\mathbf{\hat{x}}_f(k \mid k)$}, description={estimates of the system states at time $k$ for hypothesis $f$}}
\newglossaryentry{yfk_hat}{name={$\mathbf{\hat{y}}_f(k \mid k)$}, description={estimates of the system outputs at time $k$ for hypothesis $f$}}
\newglossaryentry{Pfk}{name={$\mathbf{P}_f(k \mid k)$}, description={state estimation error covariance at time $k$ for hypothesis $f$}}
\newglossaryentry{Pfkp1_pred}{name={$\mathbf{P}_f(k+1 \mid k)$}, description={predictions of the state estimation error covariance of hypothesis $f$ at time $k+1$}}
\newglossaryentry{Pfk_pred}{name={$\mathbf{P}_f(k \mid k-1)$}, description={predictions of the state estimation error covariance of filter $f$ at time $k$}}
\newglossaryentry{xmk_hat}{name={$\mathbf{\hat{x}}_m(k \mid k)$}, description={merged estimates of the system states at time $k$ for merged hypothesis $m$}}
\newglossaryentry{ymk_hat}{name={$\mathbf{\hat{y}}_m(k \mid k)$}, description={merged estimates of the system outputs at time $k$ for merged hypothesis $m$}}
\newglossaryentry{Pmk}{name={$\mathbf{P}_m(k \mid k)$}, description={merged state estimation error covariance at time $k$ for merged hypothesis $m$}}

% Simulations
\newglossaryentry{tset95}{name=\ensuremath{t_{\pm5\%}}, description={settling time of the process to within $\pm5\%$ of steady-state}}
\newglossaryentry{Nset95}{name=\ensuremath{N_{\pm5\%}}, description={settling time of the process to within $\pm5\%$ of steady-state, measured in number of sampling intervals}}
\newglossaryentry{Tp1}{name=\ensuremath{T_{p,1}}, description={time constant of the process model used in sensitivity analysis}}
\newglossaryentry{Kp}{name=\ensuremath{K_p}, description={gain of the process model used in sensitivity analysis}}
\newglossaryentry{tstep}{name=\ensuremath{t_{step}}, description={time when a step change in the ore feed occurred in the grinding process simulations}}
\newglossaryentry{Ys}{name=\ensuremath{Y(s)}, description={Laplace transform of the process output signal}}
\newglossaryentry{Us}{name=\ensuremath{U(s)}, description={Laplace transform of the process input signal}}

% Control - REMOVED from report
%\newglossaryentry{Hp}{name={$H_p$}, description={MPC parameter : prediction horizon in number of sampling intervals}}
%\newglossaryentry{Hc}{name={$H_c$}, description={MPC parameter : control horizon in number of sampling intervals}}
%\newglossaryentry{Deltau}{name={$\Delta \mathbf{u}(k)$}, description={change in the manipulatable variable between time $k-1$ and $k$}}

% Nomenclature - see this guide:
% https://www.overleaf.com/learn/latex/Nomenclatures
%\usepackage{nomencl}
\usepackage[intoc, french, nocfg]{nomencl}
\makenomenclature

  %% Utilisation d'une autre police de caractères pour le document.
  %% - Sous LaTeX
  %\usepackage{mathpazo}      % texte et mathématiques en Palatino
  %\usepackage{mathptmx}      % texte et mathématiques en Times
  %% - Sous XeLaTeX
  %\setmainfont{TeX Gyre Pagella}      % texte en Pagella (Palatino)
  %\setmathfont{TeX Gyre Pagella Math} % mathématiques en Pagella (Palatino)
  %\setmainfont{TeX Gyre Termes}       % texte en Termes (Times)
  %\setmathfont{TeX Gyre Termes Math}  % mathématiques en Termes (Times)

  %% Options de mise en forme du mode français de babel. Consulter la
  %% documentation du paquetage babel pour les options disponibles.
  %% Désactiver (effacer ou mettre en commentaire) si l'option
  %% 'nobabel' est spécifiée au chargement de la classe.
%  \frenchbsetup{%
%    StandardItemizeEnv=true,       % format standard des listes
%    ThinSpaceInFrenchNumbers=true, % espace fine dans les nombres
%    og=«, fg=»                     % caractères « et » sont les guillemets
%  }

  % Citation syle (see p12 of ulthese.pdf)
  %\setcitestyle{numbers,square}
  %\setcitestyle{authoryear}  % NOT WORKING

  %% Style de la bibliographie.
 \bibliographystyle{apalike}

  %% Composition de la page frontispice. Remplacer les éléments entre < >.
  %% Supprimer les caractères < >. Couper un long titre ou un long
  %% sous-titre manuellement avec \\.
  \titre{Multiple-Model Observers for Detecting Ore Feed Disturbances in Grinding Operations}
  % \titre{Ceci est un exemple de long titre \\
  %   avec saut de ligne manuel}
  % \soustitre{Sous-titre le cas échéant}
  % \soustitre{Ceci est un exemple de long sous-titre \\
  %   avec saut de ligne manuel}
  \auteur{William J. Tubbs}
  \programme{Maîtrise en <discipline> <-- majeure, s'il y a lieu>}
  \direction{André Desbiens, directeur de recherche}
  \codirection{Jocelyn Bouchard, codirecteur de recherche}
  % \codirection{<Prénom Nom>, <codirecteur ou codirectrice> de recherche \\
  %              <Prénom Nom>, <codirecteur ou codirectrice> de recherche}

  %% Les commandes ci-dessous servent uniquement pour la création
  %% d'une page de titre (interdite lors du dépôt à la FESP).
  % \annee{<20xx>}

\begin{document}

\frontmatter                    % pages liminaires

\frontispice                    % production de la page frontispice

\include{resume}                % résumé français
\include{abstract}              % résumé anglais
\cleardoublepage

\tableofcontents                % production de la TdM
\cleardoublepage

\listoftables                   % production de la liste des tableaux
\cleardoublepage

\listoffigures                  % production de la liste des figures
\cleardoublepage

%\dedicace{<Dédicace si désiré>}
%\cleardoublepage

%\epigraphe{<Texte de l'épigraphe>}{<Source ou auteur>}
%\cleardoublepage

%\printglossaries
%\printglossary  % original code
\printglossary[type=\acronymtype]
\label{acronyms}

% See this guide: https://www.overleaf.com/learn/latex/Nomenclatures
\printnomenclature

\include{remerciements}         % remerciements
%\include{avantpropos}           % avant-propos

\mainmatter                     % corps du document

\include{introduction}          % introduction
\include{chapitre1}             % chapitre 1
\include{chapitre2}             % chapitre 2
\include{chapitre3}             % chapitre 3
%\include{chapitre4}             % chapitre 4, etc.  REMOVED - RESULTS NOT COMPLETED
\include{conclusion}            % conclusion

\appendix                       % annexes le cas échéant

\include{annexe}                % annexe A

\bibliography{references}                 % production de la bibliographie

\end{document}
